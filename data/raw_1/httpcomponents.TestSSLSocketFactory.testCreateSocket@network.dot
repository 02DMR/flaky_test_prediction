digraph PDG {
label = "testCreateSocket <3...59>";
0.27 [style = filled, label = "System.setProperty(\"javax.net.ssl.trustStore\",path); <36>", fillcolor = white, shape = ellipse];
0.13 [style = filled, label = "X509Certificate[] chain = new X509Certificate[][]; <18>", fillcolor = white, shape = ellipse];
0.30 [style = filled, label = "ServerSocket serverSocket = server.createServerSocket(0); <39>", fillcolor = white, shape = ellipse];
0.8 [style = filled, label = "CertificateFactory cf = CertificateFactory.getInstance(\"X.509\"); <13>", fillcolor = white, shape = ellipse];
0.31 [style = filled, label = "serverSocket.setSoTimeout(30000); <40>", fillcolor = white, shape = ellipse];
0.46 [style = filled, label = "Enter <3...59>", fillcolor = aquamarine, shape = diamond];
0.0 [style = filled, label = "HttpParams params = new BasicHttpParams(); <4>", fillcolor = white, shape = ellipse];
0.2 [style = filled, label = "char[] pwd = password.toCharArray(); <6>", fillcolor = white, shape = ellipse];
0.16 [style = filled, label = "chain[2] = (X509Certificate)cf.generateCertificate(in3); <21>", fillcolor = white, shape = ellipse];
0.32 [style = filled, label = "int port = serverSocket.getLocalPort(); <41>", fillcolor = white, shape = ellipse];
0.18 [style = filled, label = "ks.setCertificateEntry(\"CERT\",chain[2]); <24>", fillcolor = white, shape = ellipse];
0.11 [style = filled, label = "in2 = new ByteArrayInputStream(X509_INTERMEDIATE_CA); <16>", fillcolor = white, shape = ellipse];
0.15 [style = filled, label = "chain[1] = (X509Certificate)cf.generateCertificate(in2); <20>", fillcolor = white, shape = ellipse];
0.10 [style = filled, label = "in1 = new ByteArrayInputStream(X509_FOO); <15>", fillcolor = white, shape = ellipse];
0.26 [style = filled, label = "System.setProperty(\"javax.net.ssl.keyStorePassword\",password); <35>", fillcolor = white, shape = ellipse];
0.40 [style = filled, label = "success[0] = false; <50>", fillcolor = white, shape = ellipse];
0.42 [style = filled, label = "s = new Socket(\"localhost\",port); <52>", fillcolor = white, shape = ellipse];
0.4 [style = filled, label = "k = new RSAPrivateCrtKeySpec(new BigInteger(RSA_PUBLIC_MODULUS,16)); <8>", fillcolor = white, shape = ellipse];
0.39 [style = filled, label = "exerciseSocket(s,e,success); <49>", fillcolor = white, shape = ellipse];
0.21 [style = filled, label = "tempFile.deleteOnExit(); <29>", fillcolor = white, shape = ellipse];
0.25 [style = filled, label = "System.setProperty(\"javax.net.ssl.keyStore\",path); <34>", fillcolor = white, shape = ellipse];
0.38 [style = filled, label = "Socket s = ssf.connectSocket(null,\"localhost\",port,null,0,params); <47...48>", fillcolor = white, shape = ellipse];
0.7 [style = filled, label = "ks.load(null,null); <11>", fillcolor = white, shape = ellipse];
0.24 [style = filled, label = "fOut.close(); <32>", fillcolor = white, shape = ellipse];
0.6 [style = filled, label = "KeyStore ks = KeyStore.getInstance(\"JKS\"); <10>", fillcolor = white, shape = ellipse];
0.43 [style = filled, label = "s = ssf.createSocket(s,\"localhost\",port,true); <53>", fillcolor = white, shape = ellipse];
0.22 [style = filled, label = "FileOutputStream fOut = new FileOutputStream(tempFile); <30>", fillcolor = white, shape = ellipse];
0.28 [style = filled, label = "System.setProperty(\"javax.net.ssl.trustStorePassword\",password); <37>", fillcolor = white, shape = ellipse];
0.37 [style = filled, label = "listen(serverSocket,e,success); <46>", fillcolor = white, shape = ellipse];
0.12 [style = filled, label = "in3 = new ByteArrayInputStream(X509_ROOT_CA); <17>", fillcolor = white, shape = ellipse];
0.41 [style = filled, label = "listen(serverSocket,e,success); <51>", fillcolor = white, shape = ellipse];
0.14 [style = filled, label = "chain[0] = (X509Certificate)cf.generateCertificate(in1); <19>", fillcolor = white, shape = ellipse];
0.45 [style = filled, label = "{
tempFile.delete();
} <56...58>", fillcolor = deeppink, shape = ellipse];
0.3 [style = filled, label = "RSAPrivateCrtKeySpec k; <7>", fillcolor = white, shape = ellipse];
0.5 [style = filled, label = "PrivateKey pk = KeyFactory.getInstance(\"RSA\").generatePrivate(k); <9>", fillcolor = white, shape = ellipse];
0.19 [style = filled, label = "File tempFile = File.createTempFile(\"junit\",\"jks\"); <26>", fillcolor = white, shape = ellipse];
0.35 [style = filled, label = "IOException[] e = new IOException[][]; <44>", fillcolor = white, shape = ellipse];
0.20 [style = filled, label = "String path = tempFile.getCanonicalPath(); <28>", fillcolor = white, shape = ellipse];
0.29 [style = filled, label = "ServerSocketFactory server = SSLServerSocketFactory.getDefault(); <38>", fillcolor = white, shape = ellipse];
0.33 [style = filled, label = "SSLSocketFactory ssf = SSLSocketFactory.getSocketFactory(); <42>", fillcolor = white, shape = ellipse];
0.17 [style = filled, label = "ks.setKeyEntry(\"RSA_KEY\",pk,pwd,chain); <23>", fillcolor = white, shape = ellipse];
0.34 [style = filled, label = "ssf.setHostnameVerifier(SSLSocketFactory.ALLOW_ALL_HOSTNAME_VERIFIER); <43>", fillcolor = white, shape = ellipse];
0.36 [style = filled, label = "boolean[] success = new boolean[][]; <45>", fillcolor = white, shape = ellipse];
0.1 [style = filled, label = "String password = \"changeit\"; <5>", fillcolor = white, shape = ellipse];
0.9 [style = filled, label = "InputStream in1,in2,in3; <14>", fillcolor = white, shape = ellipse];
0.44 [style = filled, label = "exerciseSocket(s,e,success); <54>", fillcolor = white, shape = ellipse];
0.23 [style = filled, label = "ks.store(fOut,pwd); <31>", fillcolor = white, shape = ellipse];
0.0 -> 0.1 [style = bold, label=""];
0.0 -> 0.38 [style = solid, label="params"];
0.1 -> 0.2 [style = solid, label="password"];
0.1 -> 0.2 [style = bold, label=""];
0.1 -> 0.26 [style = solid, label="password"];
0.1 -> 0.28 [style = solid, label="password"];
0.2 -> 0.3 [style = bold, label=""];
0.2 -> 0.17 [style = solid, label="pwd"];
0.2 -> 0.23 [style = solid, label="pwd"];
0.3 -> 0.4 [style = bold, label=""];
0.3 -> 0.5 [style = solid, label="k"];
0.4 -> 0.5 [style = solid, label="k"];
0.4 -> 0.5 [style = bold, label=""];
0.5 -> 0.6 [style = bold, label=""];
0.5 -> 0.17 [style = solid, label="pk"];
0.6 -> 0.7 [style = solid, label="ks"];
0.6 -> 0.7 [style = bold, label=""];
0.6 -> 0.17 [style = solid, label="ks"];
0.6 -> 0.18 [style = solid, label="ks"];
0.6 -> 0.23 [style = solid, label="ks"];
0.7 -> 0.8 [style = bold, label=""];
0.7 -> 0.17 [style = solid, label="ks"];
0.7 -> 0.18 [style = solid, label="ks"];
0.7 -> 0.23 [style = solid, label="ks"];
0.8 -> 0.9 [style = bold, label=""];
0.8 -> 0.14 [style = solid, label="cf"];
0.8 -> 0.15 [style = solid, label="cf"];
0.8 -> 0.16 [style = solid, label="cf"];
0.9 -> 0.10 [style = bold, label=""];
0.9 -> 0.14 [style = solid, label="in1"];
0.9 -> 0.15 [style = solid, label="in2"];
0.9 -> 0.16 [style = solid, label="in3"];
0.10 -> 0.11 [style = bold, label=""];
0.10 -> 0.14 [style = solid, label="in1"];
0.11 -> 0.12 [style = bold, label=""];
0.11 -> 0.15 [style = solid, label="in2"];
0.12 -> 0.13 [style = bold, label=""];
0.12 -> 0.16 [style = solid, label="in3"];
0.13 -> 0.14 [style = bold, label=""];
0.13 -> 0.17 [style = solid, label="chain"];
0.13 -> 0.18 [style = solid, label="chain"];
0.14 -> 0.15 [style = solid, label="cf"];
0.14 -> 0.15 [style = bold, label=""];
0.14 -> 0.16 [style = solid, label="cf"];
0.14 -> 0.17 [style = solid, label="chain"];
0.14 -> 0.18 [style = solid, label="chain"];
0.15 -> 0.16 [style = solid, label="cf"];
0.15 -> 0.16 [style = bold, label=""];
0.15 -> 0.17 [style = solid, label="chain"];
0.15 -> 0.18 [style = solid, label="chain"];
0.16 -> 0.17 [style = solid, label="chain"];
0.16 -> 0.17 [style = bold, label=""];
0.16 -> 0.18 [style = solid, label="chain"];
0.17 -> 0.18 [style = solid, label="ks"];
0.17 -> 0.18 [style = bold, label=""];
0.17 -> 0.23 [style = solid, label="ks"];
0.18 -> 0.19 [style = bold, label=""];
0.18 -> 0.23 [style = solid, label="ks"];
0.19 -> 0.20 [style = solid, label="tempFile"];
0.19 -> 0.20 [style = bold, label=""];
0.19 -> 0.21 [style = solid, label="tempFile"];
0.19 -> 0.22 [style = solid, label="tempFile"];
0.19 -> 0.45 [style = solid, label="tempFile"];
0.20 -> 0.21 [style = bold, label=""];
0.20 -> 0.25 [style = solid, label="path"];
0.20 -> 0.27 [style = solid, label="path"];
0.21 -> 0.22 [style = solid, label="tempFile"];
0.21 -> 0.22 [style = bold, label=""];
0.21 -> 0.45 [style = solid, label="tempFile"];
0.22 -> 0.23 [style = solid, label="fOut"];
0.22 -> 0.23 [style = bold, label=""];
0.22 -> 0.24 [style = solid, label="fOut"];
0.23 -> 0.24 [style = bold, label=""];
0.24 -> 0.25 [style = bold, label=""];
0.25 -> 0.26 [style = bold, label=""];
0.26 -> 0.27 [style = bold, label=""];
0.27 -> 0.28 [style = bold, label=""];
0.28 -> 0.29 [style = bold, label=""];
0.29 -> 0.30 [style = solid, label="server"];
0.29 -> 0.30 [style = bold, label=""];
0.30 -> 0.31 [style = solid, label="serverSocket"];
0.30 -> 0.31 [style = bold, label=""];
0.30 -> 0.32 [style = solid, label="serverSocket"];
0.30 -> 0.37 [style = solid, label="serverSocket"];
0.30 -> 0.41 [style = solid, label="serverSocket"];
0.31 -> 0.32 [style = solid, label="serverSocket"];
0.31 -> 0.32 [style = bold, label=""];
0.31 -> 0.37 [style = solid, label="serverSocket"];
0.31 -> 0.41 [style = solid, label="serverSocket"];
0.32 -> 0.33 [style = bold, label=""];
0.32 -> 0.38 [style = solid, label="port"];
0.32 -> 0.42 [style = solid, label="port"];
0.32 -> 0.43 [style = solid, label="port"];
0.33 -> 0.34 [style = solid, label="ssf"];
0.33 -> 0.34 [style = bold, label=""];
0.33 -> 0.38 [style = solid, label="ssf"];
0.33 -> 0.43 [style = solid, label="ssf"];
0.34 -> 0.35 [style = bold, label=""];
0.34 -> 0.38 [style = solid, label="ssf"];
0.34 -> 0.43 [style = solid, label="ssf"];
0.35 -> 0.36 [style = bold, label=""];
0.35 -> 0.37 [style = solid, label="e"];
0.35 -> 0.39 [style = solid, label="e"];
0.35 -> 0.41 [style = solid, label="e"];
0.35 -> 0.44 [style = solid, label="e"];
0.36 -> 0.37 [style = solid, label="success"];
0.36 -> 0.37 [style = bold, label=""];
0.36 -> 0.39 [style = solid, label="success"];
0.36 -> 0.41 [style = solid, label="success"];
0.36 -> 0.44 [style = solid, label="success"];
0.37 -> 0.38 [style = bold, label=""];
0.38 -> 0.39 [style = solid, label="s"];
0.38 -> 0.39 [style = bold, label=""];
0.38 -> 0.43 [style = solid, label="s"];
0.38 -> 0.44 [style = solid, label="s"];
0.39 -> 0.40 [style = bold, label=""];
0.40 -> 0.41 [style = solid, label="success"];
0.40 -> 0.41 [style = bold, label=""];
0.40 -> 0.44 [style = solid, label="success"];
0.41 -> 0.42 [style = bold, label=""];
0.42 -> 0.43 [style = solid, label="s"];
0.42 -> 0.43 [style = bold, label=""];
0.42 -> 0.44 [style = solid, label="s"];
0.43 -> 0.44 [style = solid, label="s"];
0.43 -> 0.44 [style = bold, label=""];
0.44 -> 0.45 [style = bold, label=""];
0.46 -> 0.0 [style = dotted, label="true"];
0.46 -> 0.0 [style = bold, label=""];
0.46 -> 0.1 [style = dotted, label="true"];
0.46 -> 0.2 [style = dotted, label="true"];
0.46 -> 0.3 [style = dotted, label="true"];
0.46 -> 0.4 [style = dotted, label="true"];
0.46 -> 0.5 [style = dotted, label="true"];
0.46 -> 0.6 [style = dotted, label="true"];
0.46 -> 0.7 [style = dotted, label="true"];
0.46 -> 0.8 [style = dotted, label="true"];
0.46 -> 0.9 [style = dotted, label="true"];
0.46 -> 0.10 [style = dotted, label="true"];
0.46 -> 0.11 [style = dotted, label="true"];
0.46 -> 0.12 [style = dotted, label="true"];
0.46 -> 0.13 [style = dotted, label="true"];
0.46 -> 0.14 [style = dotted, label="true"];
0.46 -> 0.15 [style = dotted, label="true"];
0.46 -> 0.16 [style = dotted, label="true"];
0.46 -> 0.17 [style = dotted, label="true"];
0.46 -> 0.18 [style = dotted, label="true"];
0.46 -> 0.19 [style = dotted, label="true"];
0.46 -> 0.20 [style = dotted, label="true"];
0.46 -> 0.21 [style = dotted, label="true"];
0.46 -> 0.22 [style = dotted, label="true"];
0.46 -> 0.23 [style = dotted, label="true"];
0.46 -> 0.24 [style = dotted, label="true"];
0.46 -> 0.25 [style = dotted, label="true"];
0.46 -> 0.26 [style = dotted, label="true"];
0.46 -> 0.27 [style = dotted, label="true"];
0.46 -> 0.28 [style = dotted, label="true"];
0.46 -> 0.29 [style = dotted, label="true"];
0.46 -> 0.30 [style = dotted, label="true"];
0.46 -> 0.31 [style = dotted, label="true"];
0.46 -> 0.32 [style = dotted, label="true"];
0.46 -> 0.33 [style = dotted, label="true"];
0.46 -> 0.34 [style = dotted, label="true"];
0.46 -> 0.35 [style = dotted, label="true"];
0.46 -> 0.36 [style = dotted, label="true"];
0.46 -> 0.37 [style = dotted, label="true"];
0.46 -> 0.38 [style = dotted, label="true"];
0.46 -> 0.39 [style = dotted, label="true"];
0.46 -> 0.40 [style = dotted, label="true"];
0.46 -> 0.41 [style = dotted, label="true"];
0.46 -> 0.42 [style = dotted, label="true"];
0.46 -> 0.43 [style = dotted, label="true"];
0.46 -> 0.44 [style = dotted, label="true"];
}
